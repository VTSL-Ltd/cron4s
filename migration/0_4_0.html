<!DOCTYPE html><html><head><title>Cron4s: Migrating From 0.3.x to 0.4.0</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Antonio Alonso Dominguez" /><meta name="description" content="Scala CRON Parser" /><meta name="og:image" content="/cron4s/img/poster.png" /><meta name="image" property="og:image" content="/cron4s/img/poster.png" /><meta name="og:title" content="Cron4s: Migrating From 0.3.x to 0.4.0" /><meta name="title" property="og:title" content="Cron4s: Migrating From 0.3.x to 0.4.0" /><meta name="og:site_name" content="Cron4s" /><meta name="og:url" content="https://alonsodomin.github.io/cron4s" /><meta name="og:type" content="website" /><meta name="og:description" content="Scala CRON Parser" /><link rel="icon" type="image/png" href="/cron4s/img/favicon.png" /><meta name="twitter:title" content="Cron4s: Migrating From 0.3.x to 0.4.0" /><meta name="twitter:image" content="/cron4s/img/poster.png" /><meta name="twitter:description" content="Scala CRON Parser" /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/cron4s/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/cron4s/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/cron4s/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/cron4s/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/cron4s/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/cron4s/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/cron4s/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/cron4s/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/cron4s/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/cron4s/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/cron4s/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/cron4s/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/cron4s/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/cron4s/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/cron4s/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/cron4s/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/cron4s/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/cron4s/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/cron4s/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/cron4s/img/favicon310x150.png" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/cron4s/highlight/styles/atom-one-light.css" /><link rel="stylesheet" href="/cron4s/css/light-style.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><div id="sidebar-brand"><a href="/cron4s/" class="brand"><div class="brand-wrapper"></div><span>Cron4s</span></a><button id="main-toggle" class="sidebar-toggle"><span class="close"></span></button></div><div class="sidebar-nav">           <div class="sidebar-nav-item  "><a href="migration/index.html" title="Migration Guides" class="">Migration Guides</a></div> <div class="sidebar-nav-item  "><a href="migration/0_4_1.html" title="0.4.0 -> 0.4.1" class="">0.4.0 -> 0.4.1</a></div> <div class="sidebar-nav-item  "><a href="migration/0_4_0.html" title="0.3.x -> 0.4.x" class="">0.3.x -> 0.4.x</a></div> <div class="sidebar-nav-item  "><a href="migration/0_3_0.html" title="0.2.x -> 0.3.0" class="">0.2.x -> 0.3.0</a></div></div></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/alonsodomin/cron4s" target="_blank" rel="noopener noreferrer"><i class="fa fa-eye"></i><span>Watchers<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/alonsodomin/cron4s" target="_blank" rel="noopener noreferrer"><i class="fa fa-star-o"></i><span>Stars<span id="stars" class="label label-default">--</span></span></a></li></ul></div></div></div></div><div id="content" data-github-owner="alonsodomin" data-github-repo="cron4s"><div class="content-wrapper"><section><p>The path from 0.3.x version to 0.4.0 has some rough edges due to some small changes in the public API.</p>

<h3 id="ast-changes">AST Changes</h3>

<p>Cron4s 0.4.0 comes (finally) with support for using <code class="highlighter-rouge">?</code> symbols in the <em>day of month</em> and <em>day of week</em> fields. This
 also means that the ast node that represents those fields has a type that is different from other ones. This prevents
 the programmatically creation of cron expressions using that symbol in fields where it is illegal.</p>

<p>The bad thing is that code that this breaks the binary compatibility of between 0.4.0 and previous 0.3.x and code that
 was accessing the fields themselves will need to be re-compiled.</p>

<h3 id="breaking-api-changes">Breaking API Changes</h3>

<p>These are the most notable changes in Cron4s that will require users to update their code to be able to use this version.</p>

<h4 id="node-step-semantic-changes">Node Step Semantic Changes</h4>

<p>The semantics of the operations <code class="highlighter-rouge">step</code>, <code class="highlighter-rouge">next</code> and <code class="highlighter-rouge">prev</code> have slightly changed their semantics in 0.4.0. The key
 difference will be observed when the result of stepping over a field does not alter the field value; in such a case
 the <code class="highlighter-rouge">step</code> and related methods will return a <code class="highlighter-rouge">None</code>, meaning that there was no valid result.</p>

<h4 id="jsr-310-unification">JSR-310 Unification</h4>

<p>Support for JSR-310 (the <em>Java Time API</em>), which was split between the packages <code class="highlighter-rouge">cron4s.lib.javatime</code> in the JVM and
 the package <code class="highlighter-rouge">cron4s.lib.threetenbp</code> in ScalaJS, has been unified in both platforms using the former package name.
 That means that ScalaJS code that was using the JSR-310 backport should change now to <code class="highlighter-rouge">cron4s.lib.javatime</code> and
 everything should work the same way.</p>

<blockquote>
  <p><strong>Note</strong>: JSR-310 support in ScalaJS is not yet final but it’s mature enough to be used. This change removes the
burden of dealing with two separate namespaces for the same APIs.</p>
</blockquote>

<h4 id="joda-time-module">Joda Time Module</h4>

<p>Joda Time is support is no longer included in the core module, it has been moved to the <code class="highlighter-rouge">cron4s-joda</code> module. To 
 continue using it you must include this last module among your dependencies:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="n">libraryDependencies</span> <span class="o">+=</span> <span class="s">"com.github.alonsodomin.cron4s"</span> <span class="o">%%</span> <span class="s">"cron4s-joda"</span> <span class="o">%</span> <span class="s">"0.6.1"</span>
</code></pre>
</div>

<h4 id="field-access-from-expressions">Field access from expressions</h4>

<p>The generic field access method named <code class="highlighter-rouge">field</code> has changed its signature. The change comes motivated by the new AST node
 and basically because in the previous version there was some awful runtime casting going on. The old and new signatures
 are as follows:</p>

<p>Old signature:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">field</span><span class="o">[</span><span class="kt">F</span> <span class="k">&lt;:</span> <span class="kt">CronField</span><span class="o">](</span><span class="k">implicit</span> <span class="n">unit</span><span class="k">:</span> <span class="kt">CronUnit</span><span class="o">[</span><span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">Option</span><span class="o">[</span><span class="kt">FieldNode</span><span class="o">[</span><span class="kt">F</span><span class="o">]]</span>
</code></pre>
</div>

<p>New signature:</p>

<div class="language-scala highlighter-rouge"><pre class="highlight"><code><span class="k">def</span> <span class="n">field</span><span class="o">[</span><span class="kt">F</span> <span class="k">&lt;:</span> <span class="kt">CronField</span><span class="o">](</span><span class="k">implicit</span> <span class="n">selector</span><span class="k">:</span> <span class="kt">FieldSelector</span><span class="o">[</span><span class="kt">CronExpr</span>, <span class="kt">F</span><span class="o">])</span><span class="k">:</span> <span class="kt">selector.Out</span><span class="o">[</span><span class="kt">F</span><span class="o">]</span>
</code></pre>
</div>

<p>The new signature looks more complex than the previous one and sort of returns a magic type out of that implicit <code class="highlighter-rouge">selector</code>.
 However it comes with a big benefit:</p>

<p>The return type is now calculated at compile time and will return the right type for the given field or the code won’t 
 compile. No need to work with the resulting <code class="highlighter-rouge">Option</code> anymore.</p>

<h4 id="scalaz-vs-cats">Scalaz VS Cats</h4>

<p>Previous versions of <code class="highlighter-rouge">cron4s</code> were using <a href="http://www.scalaz.org">Scalaz</a> internally as a foundation for some of the
 common abstractions used to implement the core functionality. In 0.4.0 Scalaz has been replaced by
 <a href="http://www.typelevel.org/cats">Cats</a> for exactly the same purpise. Cats is more lightweight than Scalaz and provides
 better integration with the Scala standard library.</p>
</section></div></div></div></div><script src="/cron4s/highlight/highlight.pack.js"></script><script>
// For all code blocks, copy the language from the containing div
// to the inner code tag (where hljs expects it to be)
const langPrefix = 'language-';
document.querySelectorAll(`div[class^='${langPrefix}']`).forEach(function(div) {
  div.classList.forEach(function(cssClass) {
    if (cssClass.startsWith(langPrefix)) {
      const lang = cssClass.substring(langPrefix.length);
      div.querySelectorAll('pre code').forEach(function(code) {
        code.classList.add(lang);
      });
    }
  });
});

hljs.configure({languages:['scala','java','bash']});
hljs.initHighlightingOnLoad();
      </script><script>console.info('\x57\x65\x62\x73\x69\x74\x65\x20\x62\x75\x69\x6c\x74\x20\x77\x69\x74\x68\x3a\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x5f\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x5f\x20\x5f\x5f\x0a\x20\x20\x20\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x5f\x20\x20\x2f\x20\x2f\x5f\x20\x20\x20\x20\x20\x20\x5f\x5f\x5f\x5f\x20\x5f\x5f\x5f\x20\x20\x28\x5f\x29\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x28\x5f\x29\x20\x2f\x5f\x5f\x5f\x5f\x20\x20\x5f\x5f\x5f\x5f\x5f\x0a\x20\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x60\x5f\x5f\x20\x5c\x2f\x20\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x5f\x2f\x20\x5f\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x20\x2f\x20\x5f\x5f\x2f\x20\x5f\x20\x5c\x2f\x20\x5f\x5f\x5f\x2f\x0a\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x5f\x2f\x20\x2f\x20\x2f\x5f\x2f\x5f\x5f\x5f\x5f\x5f\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x20\x2f\x5f\x5f\x2f\x20\x2f\x20\x20\x2f\x20\x2f\x5f\x2f\x20\x28\x5f\x5f\x20\x20\x29\x20\x2f\x20\x2f\x5f\x2f\x20\x20\x5f\x5f\x28\x5f\x5f\x20\x20\x29\x0a\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2e\x5f\x5f\x5f\x2f\x5c\x5f\x5f\x2f\x20\x20\x20\x20\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x20\x2f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x2f\x20\x20\x20\x5c\x5f\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x5f\x2f\x5c\x5f\x5f\x2f\x5c\x5f\x5f\x5f\x2f\x5f\x5f\x5f\x5f\x2f\x0a\x0a\x68\x74\x74\x70\x73\x3a\x2f\x2f\x34\x37\x64\x65\x67\x2e\x67\x69\x74\x68\x75\x62\x2e\x69\x6f\x2f\x73\x62\x74\x2d\x6d\x69\x63\x72\x6f\x73\x69\x74\x65\x73')</script><script>((window.gitter = {}).chat = {}).options = {
room: 'alonsodomin/cron4s'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/cron4s/js/docs.js"></script></body></html>